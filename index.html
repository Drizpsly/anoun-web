<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>F3lip Anonymity</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Lexend font -->
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;700&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    height: 100vh;
    overflow: hidden;
    font-family: "Lexend", system-ui, sans-serif;
    font-weight: 300;
    background: #000;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
  }

  /* Floating blurred blobs */
  .blob {
    position: absolute;
    width: 450px;
    height: 450px;
    border-radius: 50%;
    filter: blur(80px);
    opacity: 0.7;
    animation: float 12s infinite alternate ease-in-out;
  }

  .blob1 { background: #111; top: 10%; left: 10%; animation-duration: 10s; }
  .blob2 { background: #2a2a2a; top: 50%; left: 60%; animation-duration: 12s; }
  .blob3 { background: #d0d0d0; top: 70%; left: 20%; opacity: 0.4; animation-duration: 14s; }

  @keyframes float {
    0%   { transform: translate(0,0) scale(1); }
    100% { transform: translate(80px, -60px) scale(1.2); }
  }

  /* Blur background only */
  .blur-layer {
    position: absolute;
    inset: 0;
    backdrop-filter: blur(30px);
    z-index: 1;
  }

  /* Foreground content */
  .content {
    position: relative;
    z-index: 2;
  }

  #timeDisplay {
    font-size: 0.9rem;
    opacity: 0.8;
    margin-bottom: 8px;
    letter-spacing: 0.08em;
  }

  h1 {
    font-size: 2.2rem;
    letter-spacing: 0.14em;
    margin-bottom: 8px;
    font-weight: 700;
  }

  .sub {
    font-size: 0.85rem;
    opacity: 0.7;
    letter-spacing: 0.25em;
    margin-bottom: 22px;
    text-transform: uppercase;
  }

  /* Search bar */
  .search-box {
    display: flex;
    gap: 10px;
    background: rgba(255,255,255,0.08);
    padding: 12px 18px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.15);
    width: 80vw;
    max-width: 500px;
    transition: 0.2s ease;
  }

  .search-box:hover {
    background: rgba(255,255,255,0.12);
  }

  input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: white;
    font-size: 0.95rem;
    font-family: "Lexend", system-ui, sans-serif;
    font-weight: 300;
  }

  button {
    background: #444;
    border: none;
    padding: 8px 18px;
    border-radius: 14px;
    color: white;
    cursor: pointer;
    transition: 0.2s;
    font-family: "Lexend", system-ui, sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  button:hover {
    background: #666;
  }

  .ddg-note {
    margin-top: 6px;
    font-size: 0.7rem;
    opacity: 0.65;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  /* VPN connect button / area */
  .vpn-section {
    margin-top: 18px;
  }

  #vpnButton {
    padding: 10px 22px;
    border-radius: 18px;
  }

  .vpn-status {
    margin-top: 10px;
    font-size: 0.8rem;
    opacity: 0.85;
    min-height: 24px;
  }

  .vpn-loading-dots {
    display: inline-flex;
    gap: 4px;
    margin-left: 6px;
    vertical-align: middle;
  }

  .vpn-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #ffffff;
    opacity: 0.6;
    animation: bounce 0.9s infinite ease-in-out;
  }

  .vpn-dot:nth-child(2) { animation-delay: 0.15s; }
  .vpn-dot:nth-child(3) { animation-delay: 0.3s; }

  @keyframes bounce {
    0%, 80%, 100% { transform: translateY(0); opacity: 0.4; }
    40% { transform: translateY(-6px); opacity: 1; }
  }

  /* VPN info panel */
  #vpnPanel {
    margin: 14px auto 0;
    padding: 12px 16px;
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,0.18);
    background: rgba(0,0,0,0.75);
    backdrop-filter: blur(14px);
    max-width: 480px;
    width: 90vw;
    font-size: 0.85rem;
    display: none;
    text-align: left;
  }

  .vpn-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    margin-bottom: 8px;
  }

  .vpn-left {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .vpn-flag {
    font-size: 1.5rem;
  }

  .vpn-country-name {
    font-weight: 700;
    font-size: 0.95rem;
  }

  .vpn-protected {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.8rem;
    opacity: 0.9;
  }

  .vpn-lock {
    width: 18px;
    height: 18px;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.7);
    position: relative;
    opacity: 0.9;
  }

  .vpn-lock::before {
    content: "";
    position: absolute;
    inset: 4px 5px;
    border-radius: 3px;
    border: 1px solid rgba(255,255,255,0.7);
  }

  .vpn-lock::after {
    content: "";
    position: absolute;
    left: 4px;
    right: 4px;
    top: -6px;
    height: 8px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.7);
  }

  .vpn-buttons {
    margin-top: 8px;
    display: flex;
    gap: 8px;
    justify-content: flex-end;
  }

  .vpn-btn-disconnect {
    background: #662b2b;
  }

  .vpn-btn-disconnect:hover {
    background: #8a3838;
  }

  .vpn-btn-reconnect {
    background: #2f4f2f;
  }

  .vpn-btn-reconnect:hover {
    background: #3e6b3e;
  }

  /* Overlay container for browser */
  #browserOverlay {
    position: fixed;
    inset: 0;
    display: none;
    flex-direction: column;
    background: #050008;
    z-index: 999;
    font-family: "Lexend", system-ui, sans-serif;
  }

  /* Toolbar - now gray */
  #torToolbar {
    height: 44px;
    background: linear-gradient(90deg, #3a3a3a, #323232, #3a3a3a);
    border-bottom: 1px solid #555;
    display: flex;
    align-items: center;
    padding: 0 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.7);
    font-size: 0.75rem;
  }

  #tabBar {
    display: flex;
    align-items: stretch;
    gap: 4px;
    flex: 1;
    overflow-x: auto;
  }

  .tab {
    display: flex;
    align-items: center;
    max-width: 200px;
    padding: 5px 9px;
    border-radius: 10px 10px 0 0;
    background: #444;
    border: 1px solid #555;
    border-bottom: none;
    color: #eee;
    font-size: 0.75rem;
    cursor: pointer;
    opacity: 0.85;
    transition: 0.15s ease;
    box-shadow: 0 0 0 rgba(0,0,0,0);
    font-family: "Lexend", system-ui, sans-serif;
  }

  .tab-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-right: 6px;
  }

  .tab-close {
    font-size: 0.9rem;
    background: transparent;
    border: none;
    color: #ccc;
    cursor: pointer;
    padding: 0 3px;
    border-radius: 50%;
    font-family: "Lexend", system-ui, sans-serif;
  }

  .tab-close:hover {
    background: rgba(255,255,255,0.15);
    color: #fff;
  }

  .tab.active {
    background: #5a5a5a;
    color: #fff;
    opacity: 1;
    box-shadow: 0 0 10px rgba(0,0,0,0.7);
    border-color: #777;
  }

  #addTabBtn {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    border: 1px solid #777;
    color: #eee;
    background: #3a3a3a;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin-left: 6px;
    flex-shrink: 0;
    font-family: "Lexend", system-ui, sans-serif;
    font-weight: 700;
  }

  #addTabBtn:hover {
    background: #4a4a4a;
  }

  #torStatus {
    margin-left: 12px;
    font-size: 0.7rem;
    color: #e0e0e0;
    display: flex;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  #torDot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #e0e0e0, #777);
    box-shadow: 0 0 10px rgba(224,224,224,0.9);
  }

  /* Embedded browser area */
  #frameContainer {
    position: relative;
    width: 100%;
    height: calc(100vh - 44px);
    background: #000;
  }

  .tab-frame {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    border: none;
    display: none;
  }

  #overlayCloseBtn {
    position: absolute;
    top: 8px;
    right: 10px;
    background: transparent;
    border: none;
    color: #f0f0f0;
    cursor: pointer;
    font-size: 0.8rem;
    padding: 4px 10px;
    border-radius: 999px;
    border: 1px solid rgba(240,240,240,0.6);
    backdrop-filter: blur(6px);
    font-family: "Lexend", system-ui, sans-serif;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  #overlayCloseBtn:hover {
    background: rgba(255,255,255,0.08);
  }

  /* Scrollbar subtle */
  #tabBar::-webkit-scrollbar {
    height: 4px;
  }
  #tabBar::-webkit-scrollbar-track {
    background: transparent;
  }
  #tabBar::-webkit-scrollbar-thumb {
    background: #5a5a5a;
    border-radius: 999px;
  }

</style>
</head>
<body>

<!-- Animated background blobs -->
<div class="blob blob1"></div>
<div class="blob blob2"></div>
<div class="blob blob3"></div>

<!-- Blur layer -->
<div class="blur-layer"></div>

<!-- Browser overlay with toolbar -->
<div id="browserOverlay">
  <div id="torToolbar">
    <div id="tabBar"></div>
    <button id="addTabBtn" title="New tab">+</button>
    <div id="torStatus">
      <div id="torDot"></div>
      Embedded browser â€¢ DuckDuckGo search
    </div>
    <button id="overlayCloseBtn" onclick="closeOverlay()">Exit</button>
  </div>
  <div id="frameContainer"></div>
</div>

<!-- Foreground main UI -->
<div class="content">
  <div id="timeDisplay">Loading timeâ€¦</div>

  <h1>F3LIP ANONYMITY</h1>
  <div class="sub">PRIVATE â€¢ SECURE â€¢ ANONYMOUS</div>

  <form class="search-box" onsubmit="handleSearch(event)">
    <input id="search" placeholder="Search the web or type a URLâ€¦" />
    <button type="submit">Go</button>
  </form>
  <div class="ddg-note">Powered by DuckDuckGo for searches</div>

  <div class="vpn-section">
    <button id="vpnButton">Connect VPN</button>
    <div class="vpn-status" id="vpnStatus"></div>
    <div id="vpnPanel">
      <div class="vpn-row">
        <div class="vpn-left">
          <div class="vpn-flag" id="vpnFlag">ðŸ‡²ðŸ‡½</div>
          <div>
            <div class="vpn-country-name" id="vpnCountryName">Mexico</div>
            <div class="vpn-protected">
              <div class="vpn-lock"></div>
              <span id="vpnProtectedText">You're protected</span>
            </div>
          </div>
        </div>
      </div>
      <div class="vpn-buttons">
        <button class="vpn-btn-disconnect" id="vpnDisconnect">Disconnect</button>
        <button class="vpn-btn-reconnect" id="vpnReconnect">Reconnect</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ------------------ TIME API ------------------ */
async function updateTime() {
  try {
    const res = await fetch("https://worldtimeapi.org/api/ip");
    const data = await res.json();
    const date = new Date(data.datetime);
    const formatted =
      date.toLocaleDateString() + " â€¢ " + date.toLocaleTimeString();
    document.getElementById("timeDisplay").textContent = formatted;
  } catch {
    document.getElementById("timeDisplay").textContent = "Time unavailable";
  }
}
setInterval(updateTime, 1000);
updateTime();

/* ------------------ URL / SEARCH HELPERS (DuckDuckGo built-in) ------------------ */
function buildUrlFromInput(input) {
  const text = input.trim();
  if (!text) return null;

  const hasSpace = /\s/.test(text);
  const hasDot = text.includes(".");
  const startsWithProto = /^https?:\/\//i.test(text);

  if (!hasSpace && hasDot) {
    let url = text;
    if (!startsWithProto) {
      url = "https://" + url;
    }
    return url;
  }

  // DuckDuckGo for searches
  return "https://duckduckgo.com/?q=" + encodeURIComponent(text);
}

/* ------------------ TABS STATE (each tab has its own iframe) ------------------ */
let tabs = [];   // { id, url, title, frameId }
let activeTabId = null;
let nextTabId = 1;

const tabBar = document.getElementById("tabBar");
const browserOverlay = document.getElementById("browserOverlay");
const frameContainer = document.getElementById("frameContainer");
const addTabBtn = document.getElementById("addTabBtn");

/* Create a new tab + iframe and activate it */
function openInNewTab(url) {
  const title = extractTitleFromUrl(url);

  const id = nextTabId++;
  const frameId = "frame-" + id;

  const iframe = document.createElement("iframe");
  iframe.className = "tab-frame";
  iframe.id = frameId;
  iframe.src = url;
  frameContainer.appendChild(iframe);

  const tabData = { id, url, title, frameId };
  tabs.push(tabData);
  activeTabId = id;

  renderTabs();
  showOverlay();
  updateFramesVisibility();
}

/* Extract a short title from URL */
function extractTitleFromUrl(url) {
  try {
    const u = new URL(url);
    return u.hostname || "Tab";
  } catch {
    return "Tab";
  }
}

/* Render the tab bar */
function renderTabs() {
  tabBar.innerHTML = "";

  tabs.forEach(tab => {
    const tabEl = document.createElement("div");
    tabEl.className = "tab" + (tab.id === activeTabId ? " active" : "");
    tabEl.dataset.id = tab.id;

    const titleSpan = document.createElement("span");
    titleSpan.className = "tab-title";
    titleSpan.textContent = tab.title;

    const closeBtn = document.createElement("button");
    closeBtn.className = "tab-close";
    closeBtn.textContent = "Ã—";
    closeBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      closeTab(tab.id);
    });

    tabEl.appendChild(titleSpan);
    tabEl.appendChild(closeBtn);

    tabEl.addEventListener("click", () => {
      if (activeTabId !== tab.id) {
        activeTabId = tab.id;
        renderTabs();
        updateFramesVisibility();
      }
    });

    tabBar.appendChild(tabEl);
  });

  if (tabs.length === 0) {
    closeOverlay();
  }
}

/* Show only active tab's iframe, keep others hidden but alive */
function updateFramesVisibility() {
  tabs.forEach(tab => {
    const frame = document.getElementById(tab.frameId);
    if (!frame) return;
    frame.style.display = (tab.id === activeTabId) ? "block" : "none";
  });
}

/* Close a tab and remove its iframe */
function closeTab(id) {
  const index = tabs.findIndex(t => t.id === id);
  if (index === -1) return;

  const [removed] = tabs.splice(index, 1);

  const frame = document.getElementById(removed.frameId);
  if (frame && frame.parentNode) {
    frame.parentNode.removeChild(frame);
  }

  if (activeTabId === id) {
    if (tabs.length > 0) {
      activeTabId = tabs[Math.max(0, index - 1)].id;
    } else {
      activeTabId = null;
    }
  }

  renderTabs();
  updateFramesVisibility();
}

/* Show/hide overlay */
function showOverlay() {
  browserOverlay.style.display = "flex";
}
function closeOverlay() {
  browserOverlay.style.display = "none";
}

/* ------------------ SEARCH HANDLER ------------------ */
function handleSearch(e) {
  e.preventDefault();
  const raw = document.getElementById("search").value;
  const url = buildUrlFromInput(raw);
  if (!url) return;
  openInNewTab(url);
}

/* Add tab button (prompt user for URL/search) */
addTabBtn.addEventListener("click", () => {
  const input = prompt("Enter a URL or search query:");
  if (!input) return;
  const url = buildUrlFromInput(input);
  if (!url) return;
  openInNewTab(url);
});

/* ------------------ VPN SIMULATION ------------------ */
const vpnCountries = [
  { name: "Mexico", flag: "ðŸ‡²ðŸ‡½" },
  { name: "Nigeria", flag: "ðŸ‡³ðŸ‡¬" },
  { name: "Eritrea", flag: "ðŸ‡ªðŸ‡·" }
];

let vpnConnected = false;
let currentCountryIndex = null;
let vpnLoadingTimeout = null;

const vpnButton = document.getElementById("vpnButton");
const vpnStatus = document.getElementById("vpnStatus");
const vpnPanel = document.getElementById("vpnPanel");
const vpnFlag = document.getElementById("vpnFlag");
const vpnCountryName = document.getElementById("vpnCountryName");
const vpnDisconnect = document.getElementById("vpnDisconnect");
const vpnReconnect = document.getElementById("vpnReconnect");

vpnButton.addEventListener("click", () => {
  if (vpnConnected) return; // already connected
  startVpnConnect();
});

function startVpnConnect() {
  vpnButton.disabled = true;
  vpnButton.textContent = "Connecting...";
  vpnStatus.innerHTML = 'Connecting to F3lip\'s VPN<span class="vpn-loading-dots"><span class="vpn-dot"></span><span class="vpn-dot"></span><span class="vpn-dot"></span></span>';
  vpnPanel.style.display = "none";

  if (vpnLoadingTimeout) {
    clearTimeout(vpnLoadingTimeout);
  }

  vpnLoadingTimeout = setTimeout(() => {
    finishVpnConnect();
  }, 5000);
}

function finishVpnConnect() {
  vpnConnected = true;
  vpnButton.disabled = false;
  vpnButton.textContent = "Connected";
  pickRandomCountry();
  vpnStatus.textContent = "";
  vpnPanel.style.display = "block";
}

function pickRandomCountry() {
  let index;
  if (currentCountryIndex === null) {
    index = Math.floor(Math.random() * vpnCountries.length);
  } else {
    const choices = vpnCountries
      .map((c, i) => i)
      .filter(i => i !== currentCountryIndex);
    index = choices[Math.floor(Math.random() * choices.length)];
  }

  currentCountryIndex = index;
  const country = vpnCountries[index];
  vpnFlag.textContent = country.flag;
  vpnCountryName.textContent = country.name;
}

/* Disconnect and reconnect */
vpnDisconnect.addEventListener("click", () => {
  vpnConnected = false;
  currentCountryIndex = null;
  vpnPanel.style.display = "none";
  vpnStatus.textContent = "VPN disconnected.";
  vpnButton.textContent = "Connect VPN";
  vpnButton.disabled = false;
});

vpnReconnect.addEventListener("click", () => {
  if (!vpnConnected) {
    startVpnConnect();
    return;
  }
  vpnStatus.innerHTML = 'Reconnecting<span class="vpn-loading-dots"><span class="vpn-dot"></span><span class="vpn-dot"></span><span class="vpn-dot"></span></span>';
  vpnPanel.style.display = "none";

  if (vpnLoadingTimeout) {
    clearTimeout(vpnLoadingTimeout);
  }

  vpnLoadingTimeout = setTimeout(() => {
    pickRandomCountry();
    vpnStatus.textContent = "";
    vpnPanel.style.display = "block";
  }, 5000);
});
</script>

</body>
</html>
